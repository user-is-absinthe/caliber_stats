<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <style>
        table, th, td {
            border: 1px solid black;
        }
        /*table {*/
        /*    width:100%;*/
        /*}*/
    </style>

    <title>Проверь свою статистику Калибра</title>

</head>

<h4>Версия 0.0.0.00.0.1 alpha</h4>

Нужен этот файл:
<br>
%UserProfile%\AppData\LocalLow\1CGS\Caliber\output_log.txt

<br>
<br>
Можно не волноваться, данные не убегут, обработка происходит исключительно локально, в браузере. <br>
Собственно, по этой прчине, отсутствует единая база и нет возможности сравнить свой результат с другими игроками.
<br>

<br>
<br>

<input type="file" id="file-input" />
<pre id="file-content"></pre>

<br>
Информация об аккаунте:
<table id="account_info">
</table>

<br>
Информация о проведенных сражениях:
<table id="battle_info">
</table>

<h6>Когда-нибудь здесь будет красота. Но не сегодня.</h6>

<script>
    function readSingleFile(e) {
        var file = e.target.files[0];
        if (!file) {
            return;
        }
        var reader = new FileReader();
        reader.onload = function(e) {
            var contents = e.target.result;
            // displayContents(contents);
            find_json(contents);
        };
        reader.readAsText(file);
    }

    function displayContents(contents) {
        var element = document.getElementById('file-content');
        element.textContent = contents;
    }

    function find_json(contents) {
        let find_line = "Request https://ru-login.caliber.ru/v1/account/unmark_entity complete: ";
        let start_line = contents.lastIndexOf(find_line);
        let all_sep = [...contents.matchAll("\n")];

        let end_line = all_sep.filter(function (index) {
            return index["index"] > start_line;
        }).slice(0)[0]["index"];

        let good_json_string = contents.substring(start_line + find_line.length, end_line);

        let good_json = JSON.parse(good_json_string);

        let nickname = good_json['nickname'];
        let credit = good_json['money']['values']['sc'];
        let gold = good_json['money']['values']['hc'];
        let level = good_json['level'];
        let free_exp = good_json['freeXp'];

        // let account_info = "".concat(
        //     "Имя аккаунта: ", nickname,
        //     "\nКоличество кредитов: ", credit,
        //     "\nКоличество золота: ", gold,
        //     "\nУровень аккаунта: ", level,
        //     "\nСвободного опыта: ", free_exp
        // );

        let table_acc_info = [
            ["Имя аккаунта", nickname],
            ["Количество кредитов", credit],
            ["Количество золота", gold],
            ["Уровень аккаунта", level],
            ["Свободного опыта", free_exp]
        ];
        add_data_to_table("account_info", table_acc_info);


        let training = good_json['matchCount']['polygon'];
        let pve = good_json['matchCount']['pve'];
        let pve_hard = good_json['matchCount']['pvehard'];
        let pvp = good_json['matchCount']['pvp'];
        let hack_net = good_json['matchCount']['hacking'];
        let pvp_pve = good_json['matchCount']['pvpve'];

        let win_pve = good_json['matchesWon']['pve'];
        let win_pve_hard = good_json['matchesWon']['pvehard'];
        let win_pvp = good_json['matchesWon']['pvp'];
        let win_hack_net = good_json['matchesWon']['hacking'];
        let win_pvp_pve = good_json['matchesWon']['pvpve'];

        let percent_pve = Math.round(win_pve / pve * 100 * 100) / 100;
        let percent_pve_hard = Math.round(win_pve_hard / pve_hard * 100 * 100) / 100;
        let percent_pvp = Math.round(win_pvp / pvp * 100 * 100) / 100;
        let percent_hack_net = Math.round(win_hack_net / hack_net * 100 * 100) / 100;
        let percent_pvp_pve = Math.round(win_pvp_pve / pvp_pve * 100 * 100) / 100;

        let table_battle_info = [
            ["", "Тренировка", "PvE", "Спецоперация", "PvP", "Взлом", "Фронт"],
            ["Всего игр", training, pve, pve_hard, pvp, hack_net, pvp_pve],
            ["Побед", 0, win_pve, win_pve_hard, win_pvp, win_hack_net, win_pvp_pve],
            ["% побед", 0, percent_pve, percent_pve_hard, percent_pvp, percent_hack_net, percent_pvp_pve],
        ];
        add_data_to_table("battle_info", table_battle_info)
        // displayContents(table_acc_info);
        // console.log(start_line, end_line)
    }


    function add_data_to_table(table_name, data) {
        // console.log(data);
        let table = document.getElementById(table_name);

        for (let index_line in data) {
            let row = table.insertRow(-1);
            for (let cell_index in data[index_line]) {
                let cell = row.insertCell(-1);
                cell.innerHTML = data[index_line][cell_index]
            }
        }
    }

    document.getElementById('file-input')
        .addEventListener('change', readSingleFile, false);
</script>